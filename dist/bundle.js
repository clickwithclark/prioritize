(()=>{"use strict";function e(){return JSON.parse(localStorage.getItem("state"))}function t(e){localStorage.setItem("state",JSON.stringify(e))}function o(){const t={...{...e()}?.todos};return 0===Object.keys(t).length?(document.querySelector("#todoList").style.opacity="0.5",{2592696:{id:2592696,message:"Pay electric bill",date:"2021-03-30T02:05:02.587Z",category:null,completed:!1},12462012:{id:"12462012",message:" feed dog",date:"2021-03-30T02:04:30.913Z",category:"Chores",completed:!1},41152409:{id:41152409,message:"cheese",date:"2021-03-30T02:03:53.599Z",category:"Grocery",completed:!1},53541349:{id:53541349,message:"milk",date:"2021-03-30T02:03:53.599Z",category:"Grocery",completed:!1},95110512:{id:95110512,message:" dishes",date:"2021-03-30T02:04:20.509Z",category:"Chores",completed:!1},98802921:{id:"98802921",message:"fix Timmy's bicycle",date:"2021-03-30T02:12:28.203Z",category:null,completed:!1}}):t}function n(o){const n={...e()},s={...n?.todos};if(0===Object.keys(s).length)return;let r=s[o.id];r={...r,...o},Object.assign(s,{[r.id]:r}),n.todos=s,t(n)}function s(o){const n={...e()},s=[];o.forEach((e=>{s.push(+e[0])})),n.order=s,t(n)}function r(){let o=e();o=o??{},o.updateConfig=null,t(o)}const a=document.querySelector("#todoList");function c(e){const t=document.createElement("li");t.draggable="true";const o=document.createElement("span"),n=document.createElement("i"),s=document.createElement("span"),r=document.createElement("i"),c=document.createElement("span"),i=document.createElement("i"),l=document.createElement("span");o.appendChild(n),s.className="grip",c.className="edit",o.className="checkmark",s.appendChild(r),c.appendChild(i),i.className="fas fa-edit",r.className="fas fa-arrows-alt-v",n.className="far fa-check-square",l.className="main-message",t.appendChild(l),t.dataset.id=e.id,l.innerText=e.category?`[${e.category}] ${e.message}`:`${e.message}`,e.completed&&(l.classList.add("completed"),o.classList.add("show-checkmark")),t.insertAdjacentElement("afterbegin",o),t.insertAdjacentElement("beforeend",c),t.insertAdjacentElement("beforeend",s),a.append(t)}const i=function(){const o=[...document.querySelectorAll("li")],n=[...document.querySelectorAll("[data-draggable-container]")];o.forEach((o=>{o.addEventListener("dragstart",(()=>{o.classList.add("dragging")})),o.addEventListener("dragend",(()=>{document.querySelector("#todoList").style.cursor="default",o.classList.remove("dragging"),function(){const o=[...document.querySelectorAll("li")],n=[];o.forEach((e=>{n.push(+e.dataset.id)}));const s=e();n.length>0&&(s.order=n,t(s))}()}))})),n.forEach((e=>{e.addEventListener("dragover",(t=>{t.preventDefault();const o=function(e,t){return[...e.querySelectorAll('[draggable="true"]:not(.dragging)')].reduce(((e,o)=>{const n=o.getBoundingClientRect(),s=t-n.top-n.height/2;return s<0&&s>e.offset?{offset:s,element:o}:e}),{offset:Number.NEGATIVE_INFINITY}).element}(e,t.clientY),n=document.querySelector(".dragging");n.opacity="0.5",null!=o?e.insertBefore(n,o):e.appendChild(n)}))}))},l=document.querySelector(".bubble"),d=document.querySelector("#logo");function u(){l.style.visibility="hidden",l.textContent="",d.src="",d.src="../assets/img/cwc-shades.png"}function p(e,t=3){u(),window.scrollTo({top:0,behavior:"smooth"}),d.src="../assets/img/oops.png",l.style.visibility="visible",l.innerHTML=e,setTimeout((()=>{u()}),1e3*t)}function g(e,t=3){u(),window.scrollTo({top:0,behavior:"smooth"}),l.style.visibility="visible",l.textContent=e,setTimeout((()=>{u()}),1e3*t)}function m(){document.querySelector("#todoList").innerHTML="";const t=o(),n=e()?.order??[];try{if(0===n.length)return Object.keys(t).forEach((e=>{c(t[e])})),void i();n.forEach((e=>{c(t[+e])})),i(),u()}catch(e){p(e.message),console.error(),console.error(e)}}function f(o){const n=document.querySelector("#todoInput"),s=o.target.closest("li"),{id:a}=s.dataset,c=s.offsetTop,i=document.querySelector("h1").offsetTop,l=s.querySelector(".main-message"),d=l.innerText;if(l.classList.contains("completed"))return m();const u=l.innerText.replace("[","(").replace("]",")");n.value=u,n.classList.add("editing-in-progress"),n.classList.add("pop-out-fade-out"),n.placeholder=`Updating: ${d.slice(0,16)}...ðŸ“‘`,window.scrollTo({top:i,behavior:"smooth"}),n.focus();const p={};p.id=+a,function(o){const n=e();if(n?.todos?.[o.updatedTodo.id])return n.updateConfig=o,t(n);r()}({todoOffset:c,updatedTodo:p})}function y(e){return e[0].toUpperCase()+e.slice(1)}function h(e){let t=null,o=e;if(-1!==e.indexOf("("))try{t=e.match(/(\(.*?\))/).pop(),o=e.replace(t,"").trim(),t=t.replace("(","").replace(")",""),t=y(t)}catch(e){e.message=" Invalid format trying to create a category\n\nGood Example: (Category) task, (Category) other task \n            \nor \n            \n(Category): task, other task, . . .  ",p(e.message,6)}try{if(0===o.length)throw new Error(' Task left blank during multi-entry mode\n      Bad Example: task1<span class="bad">, ,</span>task2\n\n      Good Example: task1<span class="good">,</span>task2\n      ');return o=y(o),{id:Math.floor(1e8*Math.random()),message:o,date:new Date,category:t,completed:!1}}catch(e){console.error(),p(e,12)}}function b(o){const n=h(o);try{if(n)return function(o){const n={...e()},s={...n?.todos};0===Object.keys(s).length&&(document.querySelector("#todoList").style.opacity="1"),Object.assign(s,{[o.id]:o}),n.order=n?.order??[],n.order=[o.id,...n.order],n.todos=s,t(n)}(n),void m()}catch(e){console.error(e),p(e.message)}}function k(e){const t=e.split(",");try{if(t.length>30)throw new Error(`Woah ! Woah !. . . that's too many at one time!, I'll only accept <span class="good">30</span> ,\n      you tried to enter <span class="bad">${t.length}</span> Tasks !\n      `);t.forEach((e=>{b(e)}))}catch(e){console.error(e.message),p(e.message,10)}}function v(e){const t=e.split(","),o=e.match(/\((.*)\)/).pop(),n=[];return n.push(t[0].replace(":","")),t.slice(1).forEach((e=>{n.push(`(${o})${e}`)})),n.join(",")}function L(e,t,o){document.addEventListener(e,(e=>{e.target.closest(t)&&o(e)}))}const w=function(e){let t=null,n=1;return{sort(){t=t??Object.entries(o());try{if(0===t.length)return;t.sort(((e,t)=>{return o=e[1].date,(t[1].date>o?1:-1)*n;var o})),n*=-1}catch(e){console.error(e)}s(t),m(),i()},getEtries(){const e=t;return t=null,e},setSort(e){t=e}}}(),E=function(e){let t=null,n=1;return{sort(){let e,r;t=Object.entries(o());try{if(0===t.length)return;r=t.filter((e=>null!==e[1].category)),e=t.filter((e=>null===e[1].category)),w.setSort(e),w.sort(),r.sort(((e,t)=>{return o=e[1].category,(t[1].category>o?1:-1)*n;var o})),n*=-1}catch(e){console.error(e)}s([...r,...w.getEtries()]),m(),i()}}}(),S=document.querySelector(".app-container"),T=document.querySelector("#logo"),q=document.querySelector(".app-name"),C=document.querySelector(".confirmation-popup"),j=document.querySelector(".logo-container");function O(){try{let t={...e()?.todos};if(t=t??{},0===Object.keys(t).length)throw new Error("You Dont have any tasks to delete yet , That's just a demonstration");S.classList.add("blur"),T.classList.add("negate-blur"),j.classList.add("negate-blur"),q.classList.add("negate-blur"),C.classList.add("active"),C.classList.add("negate-blur"),document.body.style.overflow="hidden",p("Are you sure you want to delete all your Tasks?!",300)}catch(e){console.error(e),p(e.message,3)}}function I(){u(),document.body.style.overflow="",C.classList.remove("negate-blur"),C.classList.remove("active"),q.classList.remove("negate-blur"),j.classList.remove("negate-blur"),T.classList.remove("negate-blur"),S.classList.remove("blur"),m()}function N(){I(),p("Few! . . .that was close!",2)}function x(){const o=e();o.todos=null,o.order=null,t(o),I(),m(),g("Done! . . .")}function A(){const o={...e()},n=o?.todos;try{if(!n)throw new Error("You Dont have any tasks to delete yet , That's just a demonstration");if(0===Object.entries(n).filter((e=>!0===e[1].completed)).length)throw new Error("No tasks are completed yet . . .\nTo mark a task as complete ,\nclick on the task name");const e=Object.entries(n).filter((e=>!1===e[1].completed));o.todos=Object.fromEntries(e),t(o),s(e),m(),g("Done! . . .")}catch(e){console.error(e),p(e.message,3)}}const $=document.querySelector(".app-container"),G=document.querySelector("#logo"),D=document.querySelector(".app-name"),M=document.querySelector(".confirmation-popup"),W=document.querySelector(".logo-container");let Y;function Z(){$.classList.add("blur"),G.classList.add("negate-blur"),W.classList.add("negate-blur"),D.classList.add("negate-blur"),M.classList.add("active"),M.classList.add("tutorial"),M.classList.add("negate-blur"),document.body.style.overflowY="hidden";const e=document.createElement("h1");e.innerText="Instructions",e.style.fontFamily="CabinSketch",Y=[...M.children],M.replaceChildren();const t=document.createElement("div"),o=document.createElement("p");t.append(e),t.append(o),o.innerHTML=' \n  \n  <ol>\n  <li><p>To enter a basic task just give it a name and press enter.</p> </li>\n  <hr>\n  <li><p>To enter a task and assign it a  <span class="good">category</span> put the category inside parentheses <span class="good">(&nbsp;&nbsp;&nbsp;&nbsp;)</span>\n  </br>e.g. (Math) calculus or (Math) fractions.</p></li>\n  <hr>\n  <li>\n  <p>  Entering a task one at a time can become tedious, so you can enter multiple tasks at a time by seperating each task by a comma <span class="good"> &nbsp;,</span> </br>\n  e.g. Walk the dog<span class="good"> &nbsp;,</span> pick up milk<span class="good"> &nbsp;,</span> call Jane.</p>\n  </li>\n  <hr>\n  <li><p>  You can also include categories with them!</br> e.g.(Rufus) Walk the dog<span class="good">&nbsp;,</span> (Supermarket)pick up milk<span class="good">&nbsp;,</span> (Visiting this summer)call Jane.  </p></li>\n  <hr>\n  <li>\n  <p>  But what if you wanted to make a list all your task belonging to one category?</br>\nyou don\'t have to write... </br><span class="bad">(Grocerylist) eggs , (Grocerylist) cheese , (Grocerylist) bread</span> . . .</p></li>\n<hr>\n  <li><p> you can use a colon <span class="good">:</span> after the brackets to set\n  all following task to that group.<br/>\n  e.g. <span class="good">(Grocerylist) : eggs , cheese , bread</span>\n</p></li>\n</ol>\n\n\n<button class="tutorial-ok-btn"><i class="fas fa-check"></i></button>\n\n\n',o.classList.add("guide"),t.classList.add("instructions"),M.appendChild(t),M.scrollTo({top:0,behavior:"smooth"})}function B(e){e.preventDefault(),M.replaceChildren(...Y),I(),m()}function J(e){e.value="",e.placeholder="Add New Task...ðŸ“„",e.classList.remove("editing-in-progress")}function F(o){if("Enter"===o.key){if(o.target.classList.contains("editing-in-progress")){const o=e()?.updateConfig;if(o){const n=document.querySelector("#todoInput");try{const s=n.value.trim();if(""===s)throw new Error("Woops, update cannot be blank! . . . try deleting it instead");const a=h(s);return a.id=o.updatedTodo.id,function(o){const n={...e()},s={...n?.todos};Object.assign(s,{[o.id]:o}),n.todos=s,t(n)}(a),J(n),r(),window.scrollTo({top:o.todoOffset,behavior:"smooth"}),m()}catch(e){console.trace(e),p(e.message)}}}try{if(""===o.target.value.trim())throw new Error("Woops, you have to enter something first!");!function(){const e=document.querySelector("#todoInput").value.trim();if(-1===e.indexOf(","))return b(e);const t=e.match(/^\(.*\):|^\(.*\)\s:/i),o=e.split(/(\(([^)]*)\)[^)]*$)/),n=o[0],s=o[1];if(t)try{return 0===n.length?k(v(s)):k(`${n}${v(s)}`)}catch(e){p(`${e.message}inside`,12)}k(e)}(),o.target.value="",J(o.target),m()}catch(e){console.trace(e),p(e.message)}}}function H(e){J(e.target),r(),m()}function P(o){const n=o.target.closest("li"),{id:s}=n.dataset;n.style.transition="0.3s",n.style.opacity=0,n.style.marginTop="-40px",function(o){const n={...e()};let s=[...e()?.order];const r={...n?.todos};s=s.filter((e=>e!==o)),delete r[o],n.todos=r,n.order=s,t(n)}(+s),setTimeout((()=>{n.remove(),m()}),400)}function R(e){const t=e.target;t.classList.contains("editing-in-progress")||(t.classList.toggle("completed"),t.previousElementSibling.classList.toggle("show-checkmark"),function(e){const t=e.target,o=e.target.closest("li"),{id:s}=o.dataset;if(t.classList.contains("completed"))return n({id:s,completed:!0});n({id:s,completed:!1})}(e))}function U(){const e=document.querySelector("#todoList");[...e.querySelectorAll(".grip")].forEach((e=>{e.style.setProperty("cursor","grab")})),e.style.cursor="default"}function V(){const e=document.querySelector("#todoInput");e.classList.toggle("pop-out-fade-out"),e.focus()}function _(e){e.target.style.cursor="grabbing",document.querySelector("#todoList").style.cursor="grabbing"}function z(){L("keydown","#todoInput",F),L("focusout","#todoInput",H),L("pointerup",".edit",f),L("pointerup",".drop-down-entry",V),L("pointerdown",".grip",_),L("pointerup","#todoList",U),L("pointerdown",".main-message",R),L("pointerdown",".checkmark",P),L("pointerdown",".date-sort",w.sort),L("pointerdown",".category-sort",E.sort),L("pointerup",".delete-all",O),L("pointerup",".yes-btn",x),L("pointerup",".no-btn",N),L("pointerup",".delete-selected",A),L("pointerdown",".tutorial-btn",Z),L("pointerdown",".tutorial-ok-btn",B),m()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",z):z()})();