(()=>{"use strict";function e(){return JSON.parse(localStorage.getItem("state"))}function t(e){localStorage.setItem("state",JSON.stringify(e))}function o(){const t={...{...e()}?.todos};return 0===Object.keys(t).length?(document.querySelector("#todoList").style.opacity="0.5",{2592696:{id:2592696,message:"Pay electric bill",date:"2021-03-30T02:05:02.587Z",category:null,completed:!1},12462012:{id:"12462012",message:" feed dog",date:"2021-03-30T02:04:30.913Z",category:"Chores",completed:!1},41152409:{id:41152409,message:"cheese",date:"2021-03-30T02:03:53.599Z",category:"Grocery",completed:!1},53541349:{id:53541349,message:"milk",date:"2021-03-30T02:03:53.599Z",category:"Grocery",completed:!1},95110512:{id:95110512,message:" dishes",date:"2021-03-30T02:04:20.509Z",category:"Chores",completed:!1},98802921:{id:"98802921",message:"fix Timmy's bicycle",date:"2021-03-30T02:12:28.203Z",category:null,completed:!1}}):t}function n(o){const n={...e()},s={...n?.todos};if(0===Object.keys(s).length)return;let r=s[o.id];r={...r,...o},Object.assign(s,{[r.id]:r}),n.todos=s,t(n)}function s(o){const n={...e()},s=[];o.forEach((e=>{s.push(+e[0])})),n.order=s,t(n)}const r=document.querySelector("#todoList");function a(e){const t=document.createElement("li");t.draggable="true";const o=document.createElement("span"),n=document.createElement("i"),s=document.createElement("span"),a=document.createElement("i"),c=document.createElement("span"),l=document.createElement("i"),i=document.createElement("span");o.appendChild(n),s.className="grip",c.className="edit",o.className="checkmark",s.appendChild(a),c.appendChild(l),l.className="fas fa-edit",a.className="fas fa-arrows-alt-v",n.className="far fa-check-square",i.className="main-message",t.appendChild(i),t.dataset.id=e.id,i.innerText=e.category?`[${e.category}] ${e.message}`:`${e.message}`,e.completed&&(i.classList.add("completed"),o.classList.add("show-checkmark")),t.insertAdjacentElement("afterbegin",o),t.insertAdjacentElement("beforeend",s),t.insertAdjacentElement("beforeend",c),r.append(t)}const c=function(){const o=[...document.querySelectorAll("li")],n=[...document.querySelectorAll("[data-draggable-container]")];o.forEach((o=>{o.addEventListener("dragstart",(()=>{o.classList.add("dragging")})),o.addEventListener("dragend",(()=>{document.querySelector("#todoList").style.cursor="default",o.classList.remove("dragging"),function(){const o=[...document.querySelectorAll("li")],n=[];o.forEach((e=>{n.push(+e.dataset.id)}));const s=e();n.length>0&&(s.order=n,t(s))}()}))})),n.forEach((e=>{e.addEventListener("dragover",(t=>{t.preventDefault();const o=function(e,t){return[...e.querySelectorAll('[draggable="true"]:not(.dragging)')].reduce(((e,o)=>{const n=o.getBoundingClientRect(),s=t-n.top-n.height/2;return s<0&&s>e.offset?{offset:s,element:o}:e}),{offset:Number.NEGATIVE_INFINITY}).element}(e,t.clientY),n=document.querySelector(".dragging");n.opacity="0.5",null!=o?e.insertBefore(n,o):e.appendChild(n)}))}))},l=document.querySelector(".bubble"),i=document.querySelector("#logo");function d(){l.style.visibility="hidden",l.textContent="",i.src="",i.src="../assets/img/cwc-shades.png"}function u(e,t=3){d(),window.scrollTo({top:0,behavior:"smooth"}),i.src="../assets/img/oops.png",l.style.visibility="visible",l.innerHTML=e,setTimeout((()=>{d()}),1e3*t)}function p(e,t=3){d(),window.scrollTo({top:0,behavior:"smooth"}),l.style.visibility="visible",l.textContent=e,setTimeout((()=>{d()}),1e3*t)}function g(){document.querySelector("#todoList").innerHTML="";const t=o(),n=e()?.order??[];try{if(0===n.length)return Object.keys(t).forEach((e=>{a(t[e])})),void c();n.forEach((e=>{a(t[+e])})),c(),d()}catch(e){u(e.message),console.error(),console.error(e)}}function m(o){const n=document.querySelector("#todoInput"),s=o.target.closest("li"),{id:r}=s.dataset,a=s.offsetTop,c=document.querySelector("h1").offsetTop,l=s.querySelector(".main-message"),i=l.innerText;if(l.classList.contains("completed"))return g();const d=l.innerText.replace("[","(").replace("]",")");n.value=d,n.classList.add("editing-in-progress"),n.classList.add("pop-out-fade-out"),n.placeholder=`Updating: ${i.slice(0,16)}...ðŸ“‘`,window.scrollTo({top:c,behavior:"smooth"}),n.focus();const u={};u.id=+r,function(o){const n=e();n.updateConfig=o,t(n)}({todoOffset:a,updatedTodo:u})}function y(e){return e[0].toUpperCase()+e.slice(1)}function f(e){let t=null,o=e;if(-1!==e.indexOf("("))try{t=e.match(/(\(.*?\))/).pop(),o=e.replace(t,"").trim(),t=t.replace("(","").replace(")",""),t=y(t)}catch(e){e.message=" Invalid format trying to create a category\n\nGood Example: (Category) task, (Category) other task \n            \nor \n            \n(Category): task, other task, . . .  ",u(e.message,6)}try{if(0===o.length)throw new Error(' Task left blank during multi-entry mode\n      Bad Example: task1<span class="bad">, ,</span>task2\n\n      Good Example: task1<span class="good">,</span>task2\n      ');return o=y(o),{id:Math.floor(1e8*Math.random()),message:o,date:new Date,category:t,completed:!1}}catch(e){console.error(),u(e,12)}}function h(o){const n=f(o);try{if(n)return function(o){const n={...e()},s={...n?.todos};0===Object.keys(s).length&&(document.querySelector("#todoList").style.opacity="1"),Object.assign(s,{[o.id]:o}),n.order=n?.order??[],n.order=[o.id,...n.order],n.todos=s,t(n)}(n),void g()}catch(e){console.error(e),u(e.message)}}function b(e){const t=e.split(",");try{if(t.length>30)throw new Error(`Woah ! Woah !. . . that's too many at one time!, I'll only accept <span class="good">30</span> ,\n      you tried to enter <span class="bad">${t.length}</span> Tasks !\n      `);t.forEach((e=>{h(e)}))}catch(e){console.error(e.message),u(e.message,10)}}function k(e){const t=e.split(","),o=e.match(/\((.*)\)/).pop(),n=[];return n.push(t[0].replace(":","")),t.slice(1).forEach((e=>{n.push(`(${o})${e}`)})),n.join(",")}function v(e,t,o){document.addEventListener(e,(e=>{e.target.closest(t)&&o(e)}))}const L=function(e){let t=null,n=1;return{sort(){t=t??Object.entries(o());try{if(0===t.length)return;t.sort(((e,t)=>{return o=e[1].date,(t[1].date>o?1:-1)*n;var o})),n*=-1}catch(e){console.error(e)}s(t),g(),c()},getEtries(){const e=t;return t=null,e},setSort(e){t=e}}}(),w=function(e){let t=null,n=1;return{sort(){let e,r;t=Object.entries(o());try{if(0===t.length)return;r=t.filter((e=>null!==e[1].category)),e=t.filter((e=>null===e[1].category)),L.setSort(e),L.sort(),r.sort(((e,t)=>{return o=e[1].category,(t[1].category>o?1:-1)*n;var o})),n*=-1}catch(e){console.error(e)}s([...r,...L.getEtries()]),g(),c()}}}(),E=document.querySelector(".app-container"),S=document.querySelector("#logo"),T=document.querySelector(".app-name"),q=document.querySelector(".confirmation-popup"),C=document.querySelector(".logo-container");function j(){try{let t={...e()?.todos};if(t=t??{},0===Object.keys(t).length)throw new Error("You Dont have any tasks to delete yet , That's just a demonstration");E.classList.add("blur"),S.classList.add("negate-blur"),C.classList.add("negate-blur"),T.classList.add("negate-blur"),q.classList.add("active"),q.classList.add("negate-blur"),document.body.style.overflow="hidden",u("Are you sure you want to delete all your Tasks?!",300)}catch(e){console.error(e),u(e.message,3)}}function O(){d(),u("Few! . . .that was close!",2),document.body.style.overflow="",q.classList.remove("negate-blur"),q.classList.remove("active"),T.classList.remove("negate-blur"),C.classList.remove("negate-blur"),S.classList.remove("negate-blur"),E.classList.remove("blur"),g()}function N(){const o=e();o.todos=null,o.order=null,t(o),O(),g(),p("Done! . . .")}function I(){const o={...e()},n=o?.todos;try{if(!n)throw new Error("You Dont have any tasks to delete yet , That's just a demonstration");if(0===Object.entries(n).filter((e=>!0===e[1].completed)).length)throw new Error("No tasks are completed yet . . .\nTo mark a task as complete ,\nclick on the task name");const e=Object.entries(n).filter((e=>!1===e[1].completed));o.todos=Object.fromEntries(e),t(o),s(e),g(),p("Done! . . .")}catch(e){console.error(e),u(e.message,3)}}const x=document.querySelector(".app-container"),A=document.querySelector("#logo"),$=document.querySelector(".app-name"),G=document.querySelector(".confirmation-popup"),D=document.querySelector(".logo-container");let M;function W(){x.classList.add("blur"),A.classList.add("negate-blur"),D.classList.add("negate-blur"),$.classList.add("negate-blur"),G.classList.add("active"),G.classList.add("tutorial"),G.classList.add("negate-blur"),document.body.style.overflowY="hidden";const e=document.createElement("h1");e.innerText="Instructions",e.style.fontFamily="CabinSketch",M=[...G.children],G.replaceChildren();const t=document.createElement("div"),o=document.createElement("p");t.append(e),t.append(o),o.innerHTML=' \n  \n  <ol>\n  <li><p>To enter a basic task just give it a name and press enter.</p> </li>\n  <hr>\n  <li><p>To enter a task and assign it a  <span class="good">category</span> put the category inside parentheses <span class="good">(&nbsp;&nbsp;&nbsp;&nbsp;)</span>\n  </br>e.g. (Math) calculus or (Math) fractions.</p></li>\n  <hr>\n  <li>\n  <p>  Entering a task one at a time can become tedious, so you can enter multiple tasks at a time by seperating each task by a comma <span class="good"> &nbsp;,</span> </br>\n  e.g. Walk the dog<span class="good"> &nbsp;,</span> pick up milk<span class="good"> &nbsp;,</span> call Jane.</p>\n  </li>\n  <hr>\n  <li><p>  You can also include categories with them!</br> e.g.(Rufus) Walk the dog<span class="good">&nbsp;,</span> (Supermarket)pick up milk<span class="good">&nbsp;,</span> (Visiting this summer)call Jane.  </p></li>\n  <hr>\n  <li>\n  <p>  But what if you wanted to make a list all your task belonging to one category?</br>\nyou don\'t have to write... </br><span class="bad">(Grocerylist) eggs , (Grocerylist) cheese , (Grocerylist) bread</span> . . .</p></li>\n<hr>\n  <li><p> you can use a colon <span class="good">:</span> after the brackets to set\n  all following task to that group.<br/>\n  e.g. <span class="good">(Grocerylist) : eggs , cheese , bread</span>\n</p></li>\n</ol>\n\n\n<button class="tutorial-ok-btn"><i class="fas fa-check"></i></button>\n\n\n',o.classList.add("guide"),t.classList.add("instructions"),G.appendChild(t),G.scrollTo({top:0,behavior:"smooth"})}function Y(e){e.preventDefault(),G.replaceChildren(...M),O(),g()}function Z(){v("keydown","#todoInput",(o=>{if("Enter"===o.key){if(o.target.classList.contains("editing-in-progress")){const o=e()?.updateConfig;if(o){const n=document.querySelector("#todoInput");try{const s=n.value.trim();if(""===s)throw new Error("Woops, update cannot be blank! . . . try deleting it instead");const r=f(s);r.id=o.updatedTodo.id,function(o){const n={...e()},s={...n?.todos};Object.assign(s,{[o.id]:o}),n.todos=s,t(n)}(r),function(e){e.value="",e.placeholder="Add New Task...ðŸ“„",e.classList.remove("editing-in-progress")}(n),function(){const o=e();o.updateConfig=null,t(o)}(),window.scrollTo({top:o.todoOffset,behavior:"smooth"}),g()}catch(e){console.trace(e),u(e.message)}}return}try{if(""===o.target.value.trim())throw new Error("Woops, you have to enter something first!");!function(){const e=document.querySelector("#todoInput").value.trim();if(-1===e.indexOf(","))return h(e);const t=e.match(/^\(.*\):|^\(.*\)\s:/i),o=e.split(/(\(([^)]*)\)[^)]*$)/),n=o[0],s=o[1];if(t)try{return 0===n.length?b(k(s)):b(`${n}${k(s)}`)}catch(e){u(`${e.message}inside`,12)}b(e)}(),o.target.value=""}catch(e){console.trace(e),u(e.message)}}})),v("pointerup",".edit",m),v("pointerup",".drop-down-entry",(()=>{const e=document.querySelector("#todoInput");e.classList.toggle("pop-out-fade-out"),e.focus()})),v("pointerdown",".grip",(e=>{e.target.style.cursor="grabbing",document.querySelector("#todoList").style.cursor="grabbing"})),v("pointerup","#todoList",(e=>{const t=document.querySelector("#todoList");[...t.querySelectorAll(".grip")].forEach((e=>{e.style.setProperty("cursor","grab")})),t.style.cursor="default"})),v("pointerdown",".main-message",(e=>{const t=e.target;t.classList.contains("editing-in-progress")||(t.classList.toggle("completed"),t.previousElementSibling.classList.toggle("show-checkmark"),function(e){const t=e.target,o=e.target.closest("li"),{id:s}=o.dataset;if(t.classList.contains("completed"))return n({id:s,completed:!0});n({id:s,completed:!1})}(e))})),v("pointerdown",".checkmark",(o=>{const n=o.target.closest("li"),{id:s}=n.dataset;n.style.transition="0.3s",n.style.opacity=0,n.style.marginTop="-40px",function(o){const n={...e()};let s=[...e()?.order];const r={...n?.todos};s=s.filter((e=>e!==o)),delete r[o],n.todos=r,n.order=s,t(n)}(+s),setTimeout((()=>{n.remove(),g()}),400)})),v("pointerdown",".date-sort",L.sort),v("pointerdown",".category-sort",w.sort),v("pointerup",".delete-all",j),v("pointerup",".yes-btn",N),v("pointerup",".no-btn",O),v("pointerup",".delete-selected",I),v("pointerdown",".tutorial-btn",W),v("pointerdown",".tutorial-ok-btn",Y),g()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Z):Z()})();